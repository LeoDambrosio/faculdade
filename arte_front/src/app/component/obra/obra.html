<div *ngIf="obra" class="container mt-5">
  <a routerLink="/painel" class="btn btn-sm btn-outline-secondary mb-4">
    &leftarrow; Voltar ao Painel
  </a>
  
  <div class="row">
    
    <!-- Coluna da Imagem e Detalhes -->
    <div class="col-md-4 text-center">
      <img [src]="obra.imagem || 'https://placehold.co/300x450/eeeeee/333333?text=POSTER+N/D'" 
           class="img-fluid rounded shadow-lg" 
           alt="{{ obra.titulo }}" 
           style="max-height: 500px; object-fit: cover;">
      
      <div class="mt-3">
        <!-- Exibição da Nota Média -->
        <h4 class="text-warning fw-bold mb-0">
          <i class="bi bi-star-fill"></i> {{ obra.notaMedia ? (obra.notaMedia | number:'1.1-1') : 'S/N' }}
        </h4>
        <small class="text-muted">Nota Média ({{ obra.avaliacoes?.length || 0 }} votos)</small>
        
        <div class="mt-2">
            <span class="badge bg-primary me-2">{{ obra.tipo }}</span>
            <span class="badge bg-secondary">{{ obra.genero?.nome }}</span>
        </div>
      </div>
    </div>
    
    <!-- Coluna do Título, Sinopse e Avaliações -->
    <div class="col-md-8">
      
      <h1 class="display-4 fw-bold mb-3">{{ obra.titulo }}</h1>
      <p class="lead text-muted">{{ obra.anoLancamento }}</p>

      <h4 class="mt-4">Sinopse:</h4>
      <p>{{ obra.descricao || 'Descrição indisponível.' }}</p>

      <hr class="mt-4 mb-4">

      <!-- SEÇÃO DO FORMULÁRIO DE AVALIAÇÃO -->
      <div class="card shadow-sm p-4 bg-light">
          <h3 class="mb-3">Sua Opinião:</h3>
          <!-- ⭐️ CARREGANDO O COMPONENTE DE AVALIAÇÃO -->
          <app-avaliacao [idObra]="idObra"></app-avaliacao>
      </div>
      
      <!-- Seção para listar Avaliações existentes (Próxima etapa) -->
      <h3 class="mt-5">Comentários dos Usuários</h3>
      <p class="text-muted">Lista de avaliações virá aqui...</p>
      
    </div>
  </div>
</div>

<div *ngIf="!obra && idObra > 0" class="container mt-5 text-center alert alert-warning">
    <h2>Obra Não Encontrada</h2>
    <p>O ID {{ idObra }} não retornou dados. Verifique a rota do Backend.</p>
    <a routerLink="/painel" class="btn btn-secondary mt-3">Voltar ao Painel</a>
</div>